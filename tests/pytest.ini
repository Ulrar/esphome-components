[pytest]
# ESPHome Configuration Testing with pytest

# Test discovery
testpaths = tests
python_files = test_*.py
python_classes = Test*
python_functions = test_*

# Markers
markers =
    validation: Configuration validation tests (fast)
    compilation: Configuration compilation tests (mandatory, slow)
    simulation: Simulation mode tests
    slow: Slow tests (>30s, mostly compilation)
    ci: Tests suitable for CI/CD pipeline (fast, no hardware)

# Output and reporting
addopts = 
    -v
    --strict-markers
    --tb=short
    --color=yes
    --durations=10
    --html=build/esphome-test-report.html
    --self-contained-html
    --junit-xml=build/esphome-test-results.xml

# Logging
log_cli = true
log_cli_level = INFO
log_cli_format = %(asctime)s [%(levelname)8s] %(message)s (%(filename)s:%(lineno)d)
log_cli_date_format = %Y-%m-%d %H:%M:%S

# Test execution
timeout = 300
# Override timeout for compilation tests
timeout_method = thread

# Minimum version
minversion = 7.0